<!DOCTYPE html>

<html class="writer-html5" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="../../../img/favicon.ico" rel="shortcut icon"/>
<title>Lorentz Force Simulation: Motion of Charged Particles in Electric and Magnetic Fields - Physics and Mathematics</title>
<link href="../../../css/theme.css" rel="stylesheet"/>
<link href="../../../css/theme_extra.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" rel="stylesheet"/>
<script>
        // Current page data
        var mkdocs_page_name = "Lorentz Force Simulation: Motion of Charged Particles in Electric and Magnetic Fields";
        var mkdocs_page_input_path = "1 Physics/4 Electromagnetism/Problem_1.md";
        var mkdocs_page_url = null;
      </script>
<!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
<script>hljs.highlightAll();</script>
</head>
<body class="wy-body-for-nav" role="document">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side stickynav" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a class="icon icon-home" href="../../.."> Physics and Mathematics
        </a><div role="search">
<form action="../../../search.html" class="wy-form" id="rtd-search-form" method="get">
<input aria-label="Search docs" name="q" placeholder="Search docs" title="Type search term here" type="text"/>
</form>
</div>
</div>
<div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../..">Introduction</a>
</li>
</ul>
<p class="caption"><span class="caption-text">1 Physics</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal">1 Mechanics</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../1%20Mechanics/Problem_1/">Problem 1</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../1%20Mechanics/Problem_2/">Problem 2</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">2 Gravity</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../2%20Gravity/Problem_1/">Problem 1</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../2%20Gravity/Problem_2/">Problem 2</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../2%20Gravity/Problem_3/">Problem 3</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">3 Waves</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../3%20Waves/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal current">4 Electromagnetism</a>
<ul class="current">
<li class="toctree-l2 current"><a class="reference internal current" href="#">Lorentz Force Simulation: Motion of Charged Particles in Electric and Magnetic Fields</a>
<ul class="current">
<li class="toctree-l3"><a class="reference internal" href="#introduction">Introduction</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#applications-of-the-lorentz-force">Applications of the Lorentz Force</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#complete-python-implementation">Complete Python Implementation</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#analysis">Analysis</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#1-uniform-magnetic-field-e-0-b-0">1. Uniform Magnetic Field (E = 0, B ≠ 0)</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#2-crossed-electric-and-magnetic-fields-e-b">2. Crossed Electric and Magnetic Fields (E ⊥ B)</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#3-larmor-radius-cyclotron-radius">3. Larmor Radius (Cyclotron Radius)</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#4-energy-conservation">4. Energy Conservation</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#5-practical-example-cyclotron">5. Practical Example: Cyclotron</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">5 Circuits</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../5%20Circuits/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">6 Statistics</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../6%20Statistics/Problem_1/">Problem 1</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../6%20Statistics/Problem_2/">Problem 2</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">7 Measurements</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../7%20Measurements/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">2 Mathematics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/1%20Linear_algebra/">Linear Algebra</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/2%20Analytic_geometry/">Analytic geometry</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/3%20Calculus/">Calculus</a>
</li>
</ul>
<p class="caption"><span class="caption-text">3 Discret Mathematics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal">1 Set Theory and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/1%20Set%20Theory%20and%20.../_02%20Set_Theory/">Set Theory</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/1%20Set%20Theory%20and%20.../_03%20Relations/">Relations</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/1%20Set%20Theory%20and%20.../_04%20Functions/">Functions</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">2 Number Theory and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/2%20Number%20Theory%20and%20.../_05%20Combinatorics/">Combinatorics</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/2%20Number%20Theory%20and%20.../_08%20Number_Theory/">Number Theory</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">3 Recurrence and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/3%20Recurrence%20and%20.../_06%20Sequences_and_Series/">Sequences and Series</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/3%20Recurrence%20and%20.../_07%20Induction/">Induction</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/3%20Recurrence%20and%20.../_09%20Recurrence/">Recurrence</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">4 Graph Theory and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/4%20Graph%20Theory%20and%20.../_10%20Graph_Theory/">Graph Theory</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">5 Logic</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/5%20Logic/_01%20Logic/">Logic</a>
</li>
</ul>
</li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift">
<nav aria-label="Mobile navigation menu" class="wy-nav-top" role="navigation">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="../../..">Physics and Mathematics</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content"><div aria-label="breadcrumbs navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a aria-label="Docs" class="icon icon-home" href="../../.."></a></li>
<li class="breadcrumb-item">1 Physics</li>
<li class="breadcrumb-item">4 Electromagnetism</li>
<li class="breadcrumb-item active">Lorentz Force Simulation: Motion of Charged Particles in Electric and Magnetic Fields</li>
<li class="wy-breadcrumbs-aside">
</li>
</ul>
<hr/>
</div>
<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div class="section" itemprop="articleBody">
<h1 id="lorentz-force-simulation-motion-of-charged-particles-in-electric-and-magnetic-fields">Lorentz Force Simulation: Motion of Charged Particles in Electric and Magnetic Fields</h1>
<h2 id="introduction">Introduction</h2>
<p>The Lorentz force is the fundamental expression governing how charged particles move under the influence of electric and magnetic fields. It is given by:</p>
<div class="arithmatex">\[\vec{F} = q (\vec{E} + \vec{v} \times \vec{B})\]</div>
<p>Where:</p>
<ul>
<li>
<p><span class="arithmatex">\(q\)</span> is the charge of the particle</p>
</li>
<li>
<p><span class="arithmatex">\(\vec{E}\)</span> is the electric field vector</p>
</li>
<li>
<p><span class="arithmatex">\(\vec{B}\)</span> is the magnetic field vector</p>
</li>
<li>
<p><span class="arithmatex">\(\vec{v}\)</span> is the velocity vector of the particle</p>
</li>
</ul>
<p>This simulation demonstrates how particle motion is affected in different field configurations using numerical integration methods.</p>
<h2 id="applications-of-the-lorentz-force">Applications of the Lorentz Force</h2>
<ul>
<li>
<p><strong>Cyclotrons and Synchrotrons</strong>: Particle accelerators use magnetic fields to bend and focus beams of charged particles.</p>
</li>
<li>
<p><strong>Mass Spectrometry</strong>: Ions are separated based on their mass-to-charge ratio using magnetic and electric fields.</p>
</li>
<li>
<p><strong>Plasma Confinement</strong>: Magnetic fields are used to trap and control high-temperature plasmas in fusion devices (e.g., tokamaks).</p>
</li>
</ul>
<p>Electric fields accelerate charged particles, while magnetic fields bend their paths, causing circular or helical motion depending on the velocity vector.</p>
<h2 id="complete-python-implementation">Complete Python Implementation</h2>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D

# Physical constants
q = 1.6e-19         # Charge (Coulombs)
m = 1.67e-27        # Mass (kg) - using proton for better numerical stability      # Mass (kg)

# Choose one of the following cases:
# Case 1: Uniform magnetic field only
E = np.array([0.0, 0.0, 0.0])
B = np.array([0.0, 0.0, 1.0])

# Case 2: Crossed electric and magnetic fields (E ⊥ B)
# E = np.array([0.0, 100.0, 0.0])
# B = np.array([0.0, 0.0, 1.0])

# Case 3: Parallel E and B fields
# E = np.array([0.0, 0.0, 100.0])
# B = np.array([0.0, 0.0, 1.0])

# Case 4: Only electric field (electric field acceleration)
# E = np.array([100.0, 0.0, 0.0])
# B = np.array([0.0, 0.0, 0.0])

# Initial velocity and position
v0 = np.array([1e5, 0.0, 0.0])  # Velocity in m/s
r0 = np.array([0.0, 0.0, 0.0])  # Start at origin

dt = 1e-10
steps = 3000

# Lorentz force equation
def lorentz_force(q, E, B, v):
    return q * (E + np.cross(v, B))

# Motion simulation using Euler method
def simulate_motion(q, m, E, B, r0, v0, dt, steps):
    r = np.zeros((steps, 3))
    v = np.zeros((steps, 3))
    r[0] = r0
    v[0] = v0

    for i in range(1, steps):
        F = lorentz_force(q, E, B, v[i-1])
        a = F / m
        v[i] = v[i-1] + a * dt
        r[i] = r[i-1] + v[i] * dt

    return r, v

# Run the simulation
r, v = simulate_motion(q, m, E, B, r0, v0, dt, steps)

# Combined 2D Trajectories in One Plot

# Define field configurations to test (E, B, label, color)
cases = [
    (np.array([0.0, 0.0, 0.0]), np.array([0.0, 0.0, 1.0]), 'Magnetic Field Only', 'blue'),
    (np.array([0.0, 100.0, 0.0]), np.array([0.0, 0.0, 1.0]), 'E ⊥ B Drift', 'green'),
    (np.array([0.0, 0.0, 100.0]), np.array([0.0, 0.0, 1.0]), 'E ‖ B Fields', 'orange'),
    (np.array([100.0, 0.0, 0.0]), np.array([0.0, 0.0, 0.0]), 'Electric Field Only', 'red'),
    (np.array([50.0, 50.0, 0.0]), np.array([0.0, 0.0, 1.0]), 'Oblique E Field', 'purple'),
    (np.array([0.0, 0.0, 0.0]), np.array([1.0, 1.0, 1.0]), 'Diagonal B Field', 'brown')
]

plt.figure(figsize=(10, 8))
for E_test, B_test, label, color in cases:
    r_case, _ = simulate_motion(q, m, E_test, B_test, r0, v0, dt, steps)
    plt.plot(r_case[:, 0], r_case[:, 1], label=label, color=color)

plt.xlabel('X (m)')
plt.ylabel('Y (m)')
plt.title('Combined Trajectories in XY Plane')
plt.axis('equal')
plt.grid(True)
plt.legend()
plt.tight_layout()
plt.show()
</code></pre>
<p><img alt="trajectories-in-xy" src="../Unknown-6.png"/></p>
<h2 id="analysis">Analysis</h2>
<p>The motion of a charged particle under the influence of electric and magnetic fields can vary significantly depending on the field configuration and the particle's initial velocity. This section breaks down key physical interpretations of the simulated motion, with accompanying visual examples to aid comprehension.</p>
<h3 id="1-uniform-magnetic-field-e-0-b-0">1. Uniform Magnetic Field (E = 0, B ≠ 0)</h3>
<p>In this configuration, the particle experiences a centripetal Lorentz force perpendicular to both its velocity and the magnetic field. If the initial velocity is perpendicular to the magnetic field, the result is <strong>circular motion</strong>. If the initial velocity has components both perpendicular and parallel to the field, the particle follows a <strong>helical path</strong>.</p>
<pre><code class="language-python">plt.figure(figsize=(6,6))
plt.plot(r[:,0], r[:,1])
plt.xlabel('x (m)')
plt.ylabel('y (m)')
plt.title('Top View: Circular/Helical Motion in Uniform Magnetic Field')
plt.axis('equal')
plt.grid(True)
plt.show()
</code></pre>
<h3 id="2-crossed-electric-and-magnetic-fields-e-b">2. Crossed Electric and Magnetic Fields (E ⊥ B)</h3>
<p>When both E and B fields are present and perpendicular to each other, the charged particle undergoes a <strong>drift motion</strong>. The net motion combines the cyclotron motion with a linear drift in the direction of E × B. This is known as the <strong>E × B drift</strong>.</p>
<p>Drift velocity:</p>
<p>v_d = (E × B) / B²</p>
<p>Simulation parameters for E × B drift:</p>
<pre><code class="language-python">E = np.array([0, 1e3, 0])
B = np.array([0, 0, 1])
</code></pre>
<p>Expected result: a helical trajectory drifting in the x-direction.</p>
<h3 id="3-larmor-radius-cyclotron-radius">3. Larmor Radius (Cyclotron Radius)</h3>
<p>The Larmor radius, or gyroradius, defines the radius of circular motion in a magnetic field:</p>
<div class="arithmatex">\[r_L = (m * v_perp) / (q * B)\]</div>
<p>It depends on the particle’s mass, charge, magnetic field strength, and the perpendicular velocity component. A larger mass or velocity leads to a wider spiral.</p>
<h3 id="4-energy-conservation">4. Energy Conservation</h3>
<p>In a uniform magnetic field, the force is always perpendicular to the velocity, meaning the magnetic force does no work. Therefore, the <strong>kinetic energy of the particle remains constant</strong> throughout the motion.</p>
<h3 id="5-practical-example-cyclotron">5. Practical Example: Cyclotron</h3>
<p>A cyclotron accelerates particles using a combination of electric fields (for acceleration) and magnetic fields (to bend the path into circles). The simulation mimics the forces acting on particles in such devices, illustrating circular or helical motion—fundamental to understanding particle dynamics in accelerators.</p>
</div>
</div><footer>
<div aria-label="Footer Navigation" class="rst-footer-buttons" role="navigation">
<a class="btn btn-neutral float-left" href="../../3%20Waves/Problem_1/" title="Problem 1"><span class="icon icon-circle-arrow-left"></span> Previous</a>
<a class="btn btn-neutral float-right" href="../../5%20Circuits/Problem_1/" title="Problem 1">Next <span class="icon icon-circle-arrow-right"></span></a>
</div>
<hr/>
<div role="contentinfo">
<!-- Copyright etc -->
</div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
</div>
</div>
</section>
</div>
<div aria-label="Versions" class="rst-versions" role="note">
<span class="rst-current-version" data-toggle="rst-current-version">
<span><a href="../../3%20Waves/Problem_1/" style="color: #fcfcfc">« Previous</a></span>
<span><a href="../../5%20Circuits/Problem_1/" style="color: #fcfcfc">Next »</a></span>
</span>
</div>
<script src="../../../js/jquery-3.6.0.min.js"></script>
<script>var base_url = "../../..";</script>
<script src="../../../js/theme_extra.js"></script>
<script src="../../../js/theme.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script src="../../../search/main.js"></script>
<script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>
</body>
</html>
